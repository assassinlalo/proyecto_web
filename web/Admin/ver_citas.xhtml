<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <f:view contentType="text/html">
        <h:head>
            <title>Facelet Title</title>
             <script src="../resources/js/custom.js" />
        </h:head>
        <h:body>
            <ui:composition template="../templates/master.xhtml">
                <ui:define name="encabezado">
                    <p:commandButton value="LogOut" icon="fa fa-fw fa-sign-out" class="pull-right" action="#{master.cerrar_sesion()}"/>
                </ui:define>
                <ui:define name="cuerpo">
                    <f:metadata>
                        <f:event type="preRenderView" listener="#{dtFilterView.validaPagina()}"/>
                    </f:metadata>
                    <p:panel header="Control de Citas" style="width: 99%;">
                        <h:form>
                            <p:growl id="messages" showDetail="true" life="2500"/>
                            <p:dataTable var="cita" value="#{dtFilterView.citasP}" widgetVar="carsTable" 
                                         selection="#{dtFilterView.selectedLista}" rowKey="#{cita.idCita}"
                                         emptyMessage="No se encontraron citas con el criterio de busqueda" filteredValue="#{dtFilterView.filteredCitas}">
                                <f:facet name="header">
                                    <p:outputPanel>
                                        <h:outputText value="Search all fields:" />
                                        <p:inputText id="globalFilter" onkeyup="PF('carsTable').filter()" style="width:150px" placeholder="Introduza su búsqueda"/>
                                    </p:outputPanel>
                                </f:facet>
                                <p:column selectionMode="single" style="width:16px;text-align:center"/>
                              
                                <p:column  filterBy="#{cita.tipo}"  headerText="Tipo" footerText="" filterMatchMode="contains" >
                                    <h:outputText value="#{cita.tipo}" />
                                </p:column>
                                <p:column  filterBy="#{cita.fecha}"  headerText="Fecha" footerText="" filterMatchMode="contains" >
                                    <h:outputText value="#{cita.fecha}" />
                                </p:column>
                                <p:column  filterBy="#{cita.hora}"  headerText="Fecha" footerText="" filterMatchMode="contains" >
                                    <h:outputText value="#{cita.hora}" />
                                </p:column>
                                <p:column  filterBy="#{cita.observaciones}"  headerText="Obersvaciones" footerText="" filterMatchMode="contains" >
                                    <h:outputText value="#{cita.observaciones}" />
                                </p:column>
                                 <p:column  filterBy="#{cita.nombre}"  headerText="Obersvaciones" footerText="" filterMatchMode="contains" >
                                    <h:outputText value="#{cita.nombre}" />
                                </p:column>
                            </p:dataTable>
                            <br/>
                            <div align="center" >
                                <p:commandButton value="Eliminar" action="#{dtFilterView.deleteCita}" update="messages" /> 
                                <!--onclick="PF('dlg1').show();"-->
                            </div>
                            <p:dialog modal="true" id="dlg1" widgetVar="dlg1" draggable="false" appendTo="@(body)">
                                <h:outputText value="¿Esta seguro de eliminar esta cita?" />
                                <p:commandButton id="yes" value="Si" type="button" immediate="true" action="#{dtFilterView.deleteCita}" />
                                <p:commandButton id="no" value="no"  onclick="PF('dlg1').hide();" />
                            </p:dialog>

                        </h:form>
                    </p:panel>
                    <style type="text/css">
                        .value {
                            width: 620px;
                        }
                    </style>
                </ui:define>
            </ui:composition>
        </h:body>
    </f:view>
</html>